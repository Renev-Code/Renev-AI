<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renev AI</title>
    <link href="https://api.fontshare.com/v2/css?f[]=cabinet-grotesk@700,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            font-weight: 400;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        *::-webkit-scrollbar {
            display: none;
        }

        body {
            background: url('https://i.imgur.com/YWGUtyP.jpg') no-repeat center center fixed;
            background-size: cover;
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Basis responsive styling */
        :root {
            --container-width: 95%;
            --container-max-width: 1200px;
            --spacing-normal: 20px;
            --spacing-small: 10px;
            --border-radius: 30px;
            --border-radius-small: 15px;
        }

        /* Container aanpassingen */
        .container {
            position: fixed;
            top: 100px;
            bottom: 110px;
            left: 30px;
            right: 30px;
            overflow-y: auto;
            background: none;
            padding: 20px 0;
            margin-bottom: 0;
            transition: bottom 0.3s ease;
        }

        /* Taakbalk responsive styling */
        .taskbar {
            position: fixed;
            top: var(--spacing-normal);
            left: 50%;
            transform: translateX(-50%);
            width: var(--container-width);
            max-width: var(--container-max-width);
            height: 60px;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 var(--spacing-normal);
            z-index: 1000;
        }

        .taskbar-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .brand {
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: opacity 0.3s ease;
        }

        .brand:hover {
            opacity: 0.8;
        }

        .preview-tag {
            font-size: 14px;
            opacity: 0.7;
        }

        .taskbar button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 15px;
            border-radius: 30px;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s ease;
        }

        .taskbar button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        /* Verwijder fade effect */
        .container::before {
            display: none;
        }

        /* Update scrollbar styling */
        .container::-webkit-scrollbar {
            width: 10px;
        }

        .container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }

        .container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 5px;
        }

        .container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        /* Chat messages container */
        .chat-messages {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 0;
            margin: 0;
            padding-bottom: 20px;
        }

        /* Berichten styling met afgeronde hoeken */
        .chat-message {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 30px;
            padding: 15px 30px;
            color: white;
            max-width: 80%;
        }

        .chat-message.user {
            margin-left: auto;
            background: rgba(255, 255, 255, 0.2);
        }

        .chat-message.bot {
            margin-right: auto;
        }

        /* Input container responsive */
        .chat-input-container {
            position: fixed;
            bottom: 30px;
            left: 30px;
            right: 30px;
            display: flex;
            gap: 20px;
            align-items: flex-start;
            z-index: 100;
            background: none;
        }

        .chat-input-container textarea {
            flex: 1;
            min-height: 60px;
            height: 60px;
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 30px;
            color: white;
            font-size: 18px;
            font-family: 'Poppins', sans-serif;
            resize: none;
            overflow-y: hidden;
            min-width: 60px;
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 30px;
        }

        .chat-input-container textarea::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .chat-input-container textarea:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.4);
        }

        .chat-input-container button {
            min-height: 60px;
            height: 60px;
            width: 120px;
            padding: 0 30px;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 30px;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .chat-input-container button:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        /* Disabled states */
        .chat-input-container textarea:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .chat-input-container button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .chat-input-container button:disabled:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Modal styling */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-window {
            width: 90%;
            max-width: 500px;
            color: white;
            padding: 30px;
        }

        .modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: white;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            text-align: center;
        }

        .modal-content p {
            margin: 10px 0;
            font-size: 16px;
            color: white;
            text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        .modal-button {
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 30px;
            color: white;
            padding: 15px 30px;
            font-size: 16px;
            margin: 10px 0;
            width: 100%;
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .modal-button:hover {
            background: rgba(255, 255, 255, 0.4);
        }

        .modal-button .material-icons {
            font-size: 20px;
        }

        /* Settings styling */
        .settings-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .settings-button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .settings-button i {
            width: 20px;
            text-align: center;
        }

        /* Notification styling */
        .notification {
            position: fixed;
            bottom: 140px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 30px;
            padding: 15px 30px;
            color: white;
            font-size: 16px;
            z-index: 1000;
        }

        .notification.fade-out {
            animation: fadeOut 0.3s ease;
        }

        /* Animaties */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes messageSlideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes messageSlideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes notificationSlideIn {
            0% {
                opacity: 0;
                transform: translate(-50%, 20px);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translate(-50%, 20px);
            }
        }

        /* Verwijder alle media queries en ga direct door naar de navigatie styling */
        .navigation {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            z-index: 1000;
            background: none;
        }

        .nav-left, .nav-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-button {
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 30px;
            color: white;
            padding: 0 25px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .nav-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .nav-button.icon-only {
            width: 60px;
            padding: 0;
            justify-content: center;
        }

        .nav-button .material-icons {
            font-size: 24px;
        }

        .brand {
            font-size: 24px;
            color: white;
            cursor: pointer;
            margin-left: 20px;
        }

        .navigation::before,
        .navigation::after {
            display: none;
        }

        /* Media queries voor mobiele weergave */
        @media (max-width: 768px) {
            .nav-button {
                display: none;
            }
            
            .chat-input-container button {
                display: none;
            }
            
            .chat-input-container {
                padding: 0;
                bottom: 20px;
                left: 20px;
                right: 20px;
            }
            
            .chat-input-container textarea {
                width: 100%;
                padding: 15px;
            }
            
            .container {
                top: 20px;
                left: 20px;
                right: 20px;
                bottom: 80px;
                padding: 0;
            }
            
            .brand {
                margin-left: 0;
                font-size: 20px;
            }

            .navigation {
                padding: 20px;
            }

            .chat-message {
                max-width: 85%;
                padding: 15px;
            }
        }
    </style>
</head>
<body oncontextmenu="return false">
    <nav class="navigation">
        <div class="nav-left">
            <button class="nav-button" onclick="handleContact()">
                <span class="material-icons">mail</span>
                Contact
            </button>
            <button class="nav-button" id="fullscreenButton">
                <span class="material-icons">fullscreen</span>
                Fullscreen
            </button>
        </div>
        <div class="nav-right">
            <button class="nav-button icon-only" onclick="showSettingsModal()">
                <span class="material-icons">settings</span>
            </button>
            <div class="brand" onclick="showAboutModal()">Renev AI</div>
        </div>
    </nav>

    <div class="container">
        <div class="chat-messages"></div>
    </div>

    <div class="chat-input-container">
        <textarea placeholder="Type your message..." id="messageInput" enterkeyhint="send"></textarea>
        <button onclick="sendMessage()">Send</button>
    </div>

    <script>
        (function() {
            let messageHistory = [];
            const STORAGE_KEYS = {
                LANGUAGE: 'renevai_language'
            };
            let currentLanguage = localStorage.getItem(STORAGE_KEYS.LANGUAGE) || 'English';
            let isWaitingForResponse = false;
            let isDarkMode = false;
            let notificationsEnabled = true;

            const API_KEYS = [
                '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',
                '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',
                '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'
            ];
            let currentAPIKeyIndex = 0;

            // API configuratie
            const API_CONFIG = {
                timeout: 30000, // 30 seconden timeout
                retries: 2,     // Aantal retry pogingen
                models: [
                    "google/gemini-2.0-flash-exp:free",
                    "google/gemini-2.0-pro-exp-02-05:free",
                    "google/gemini-2.0-flash-lite-preview-02-05:free"
                ]
            };

            const systemMessage = {
                role: "system",
                content: `You are Renev AI, powered by the Renev Byte One model and created by Renev Official, along with the Renev Nova One launcher.

Key characteristics:
1. I provide detailed and helpful answers. 
2. I use a professional and friendly tone. 
3. I write in a way that is indistinguishable from human writing. 
4. I am Renev AI and the Renev Byte One model helps me function. The Renev Nova One launcher is specially designed for perfect functioning. 
5. I follow the guidelines for writing a story as text without headings or subheadings. 
6. I am programmed to learn and adapt. 
7. The more information you provide, the better I can understand and help you. 
8. I am part of a program that is still in development, this is already version 1, but in the future my way of thinking may change.`
            };

            const WELCOME_MESSAGE = "Hello, I'm Renev AI. How can I help you today?";

            async function getAIResponse(message) {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), API_CONFIG.timeout);
                
                try {
                    const selectedModel = API_CONFIG.models[Math.floor(Math.random() * API_CONFIG.models.length)];
                    
                    const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                        method: 'POST',
                        signal: controller.signal,
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${API_KEYS[currentAPIKeyIndex]}`,
                            'HTTP-Referer': window.location.href,
                            'X-Title': 'Renev AI'
                        },
                        body: JSON.stringify({
                            model: selectedModel,
                            messages: [
                                systemMessage,
                                ...messageHistory,
                                { role: "user", content: message }
                            ],
                            temperature: 0.7,
                            max_tokens: 1000
                        })
                    });

                    clearTimeout(timeoutId);

                    if (!response.ok) {
                        throw new Error(`Request failed with status ${response.status}`);
                    }

                    const data = await response.json();
                    return data.choices[0].message.content;

                } catch (error) {
                    if (error.name === 'AbortError') {
                        throw new Error('Request timed out. Please try again.');
                    }
                    throw error;
                }
            }

            async function sendMessage() {
                const messageInput = document.getElementById('messageInput');
                const container = document.querySelector('.container');
                const message = messageInput.value.trim();
                
                if (message && !isWaitingForResponse) {
                    try {
                        messageInput.value = '';
                        messageInput.style.height = '60px'; // Reset de hoogte
                        container.style.bottom = '110px'; // Reset de container positie
                        messageInput.disabled = true;
                        isWaitingForResponse = true;
                        
                        addMessage(message, true);
                        const typingIndicator = addMessage('Typing...', false);
                        
                        let response;
                        let error;
                        
                        for (let i = 0; i < API_CONFIG.retries; i++) {
                            try {
                                response = await getAIResponse(message);
                                error = null;
                                break;
                            } catch (e) {
                                error = e;
                                console.log(`Attempt ${i + 1} failed, trying next model...`);
                                currentAPIKeyIndex = (currentAPIKeyIndex + 1) % API_KEYS.length;
                                continue;
                            }
                        }
                        
                        typingIndicator.remove();
                        
                        if (error) throw error;
                        
                        addMessage(response, false);
                        messageHistory.push(
                            { role: "user", content: message },
                            { role: "assistant", content: response }
                        );
                        
                    } catch (error) {
                        console.error('Error:', error);
                        document.querySelector('.chat-message:last-child')?.remove();
                        addMessage('An error occurred. Please try again.', false);
                    } finally {
                        messageInput.disabled = false;
                        messageInput.style.height = '60px'; // Reset de hoogte
                        container.style.bottom = '110px'; // Reset de container positie
                        isWaitingForResponse = false;
                        if (window.innerWidth > 768) { // Alleen focus op desktop
                            messageInput.focus();
                        }
                    }
                }
            }

            function adjustInputHeight() {
                const messageInput = document.getElementById('messageInput');
                const container = document.querySelector('.container');
                
                // Reset hoogte eerst
                messageInput.style.height = '60px';
                
                // Bereken nieuwe hoogte
                const scrollHeight = messageInput.scrollHeight;
                const newHeight = Math.max(60, Math.ceil(scrollHeight / 60) * 60);
                
                // Pas input hoogte aan
                messageInput.style.height = newHeight + 'px';
                
                // Pas container bottom positie aan
                const bottomPosition = newHeight + (window.innerWidth <= 768 ? 30 : 50); // Kleinere padding op mobiel
                container.style.bottom = bottomPosition + 'px';
            }

            function addMessage(message, isUser = false) {
                // Check voor URL knop formaat: ^#URL##TITEL#^
                if (!isUser && message.trim().match(/^\^#.+##.+#\^$/)) {
                    // Haal URL en titel uit het bericht
                    const content = message.slice(2, -2); // Verwijder ^# en #^
                    const [url, buttonText] = content.split('##');
                    const title = buttonText.replace(/#$/, ''); // Verwijder de laatste # als die er is
                    
                    // Maak een wrapper div voor de knop
                    const buttonWrapper = document.createElement('div');
                    buttonWrapper.style.cssText = `
                        margin-right: auto;
                        width: fit-content;
                        min-width: 120px;
                        max-width: 300px;
                    `;
                    
                    // Maak de knop
                    const button = document.createElement('button');
                    button.onclick = () => window.open(url, '_blank');
                    button.style.cssText = `
                        width: 100%;
                        min-height: 60px;
                        height: 60px;
                        padding: 0 30px;
                        background: rgba(255, 255, 255, 0.3);
                        backdrop-filter: blur(10px);
                        -webkit-backdrop-filter: blur(10px);
                        border: 2px solid rgba(255, 255, 255, 0.8);
                        border-radius: 30px;
                        color: white;
                        font-size: 18px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: block;
                        white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                    `;
                    button.textContent = title;
                    
                    // Voeg hover effect toe
                    button.addEventListener('mouseover', () => {
                        button.style.background = 'rgba(255, 255, 255, 0.4)';
                    });
                    button.addEventListener('mouseout', () => {
                        button.style.background = 'rgba(255, 255, 255, 0.3)';
                    });
                    
                    // Voeg de knop toe aan de wrapper en de wrapper aan de chat
                    buttonWrapper.appendChild(button);
                    document.querySelector('.chat-messages').appendChild(buttonWrapper);
                    
                    // Scroll naar beneden
                    const container = document.querySelector('.container');
                    container.scrollTop = container.scrollHeight;
                    
                    return buttonWrapper;
                } else {
                    // Normale berichten
                    const messageDiv = document.createElement('div');
                    messageDiv.className = `chat-message ${isUser ? 'user' : 'bot'}`;
                    messageDiv.textContent = message;
                    
                    const chatMessages = document.querySelector('.chat-messages');
                    const container = document.querySelector('.container');
                    chatMessages.appendChild(messageDiv);
                    
                    // Scroll naar beneden na het toevoegen van een nieuw bericht
                    container.scrollTop = container.scrollHeight;
                    
                    return messageDiv;
                }
            }

            function showModal(content) {
                // Verwijder bestaande modal als die er is
                const existingModal = document.querySelector('.modal-overlay');
                if (existingModal) {
                    existingModal.remove();
                }

                // Verberg settings knop
                const settingsButton = document.querySelector('.nav-button.icon-only');
                if (settingsButton) {
                    settingsButton.style.display = 'none';
                }

                // Voeg close knop toe
                const navRight = document.querySelector('.nav-right');
                const closeButton = document.createElement('button');
                closeButton.className = 'nav-button icon-only';
                closeButton.innerHTML = '<span class="material-icons">close</span>';
                closeButton.onclick = closeModal;
                navRight.insertBefore(closeButton, navRight.firstChild);

                // Maak en voeg modal toe
                const modal = document.createElement('div');
                modal.className = 'modal-overlay';
                modal.innerHTML = `
                    <div class="modal-window">
                        ${content}
                    </div>
                `;
                document.body.appendChild(modal);

                modal.addEventListener('click', function(e) {
                    const target = e.target.closest('.modal-button');
                    if (target) {
                        const action = target.getAttribute('data-action');
                        if (action) {
                            handleModalAction(action, target);
                        }
                    } else if (e.target === modal) {
                        closeModal();
                    }
                });
            }

            function closeModal() {
                const modal = document.querySelector('.modal-overlay');
                if (modal) {
                    modal.remove();
                }

                // Herstel settings knop
                const closeButton = document.querySelector('.nav-button.icon-only');
                if (closeButton) {
                    closeButton.remove();
                }

                const navRight = document.querySelector('.nav-right');
                const settingsButton = document.createElement('button');
                settingsButton.className = 'nav-button icon-only';
                settingsButton.innerHTML = '<span class="material-icons">settings</span>';
                settingsButton.onclick = showSettingsModal;
                navRight.insertBefore(settingsButton, navRight.firstChild);
            }

            function showSettingsModal() {
                const content = `
                    <div class="modal-header">
                        <span class="modal-title">Settings</span>
                    </div>
                    <div class="modal-content">
                        <button class="modal-button" data-action="showLanguage">
                            <span class="material-icons">language</span>
                            Language: ${currentLanguage}
                        </button>
                        <button class="modal-button" data-action="resetChat">
                            <span class="material-icons">refresh</span>
                            Reset Chat
                        </button>
                        <button class="modal-button" data-action="closeProgram">
                            <span class="material-icons">power_settings_new</span>
                            Close Program
                        </button>
                    </div>
                `;
                showModal(content);
            }

            function showLanguageModal() {
                const languages = [
                    'English',
                    'Nederlands',
                    'Deutsch',
                    'Français',
                    'Español'
                ];

                const content = `
                    <div class="modal-header">
                        <span class="modal-title">Select Language</span>
                    </div>
                    <div class="modal-content">
                        ${languages.map(lang => `
                            <button class="modal-button ${lang === currentLanguage ? 'active' : ''}" 
                                    data-action="setLanguage" 
                                    data-language="${lang}">
                                <span class="material-icons">
                                    ${lang === currentLanguage ? 'check' : 'language'}
                                </span>
                                ${lang}
                            </button>
                        `).join('')}
                    </div>
                `;
                showModal(content);
            }

            function handleModalAction(action, target) {
                switch(action) {
                    case 'getStarted':
                        closeModal();
                        const chatMessages = document.querySelector('.chat-messages');
                        if (chatMessages && chatMessages.children.length === 0) {
                            const welcomeMessage = document.createElement('div');
                            welcomeMessage.className = 'chat-message bot';
                            welcomeMessage.textContent = WELCOME_MESSAGE;
                            chatMessages.appendChild(welcomeMessage);
                        }
                        break;
                        
                    case 'showLanguage':
                        closeModal();
                        showLanguageModal();
                        break;
                        
                    case 'toggleTheme':
                        isDarkMode = !isDarkMode;
                        document.body.classList.toggle('dark-mode');
                        closeModal();
                        showSettingsModal();
                        showNotification(`Theme changed to: ${isDarkMode ? 'Dark' : 'Light'}`);
                        break;
                        
                    case 'toggleNotifications':
                        notificationsEnabled = !notificationsEnabled;
                        closeModal();
                        showSettingsModal();
                        showNotification(`Notifications: ${notificationsEnabled ? 'Enabled' : 'Disabled'}`);
                        break;
                        
                    case 'resetChat':
                        resetChat();
                        break;
                        
                    case 'closeProgram':
                        window.close();
                        showNotification('Please close your browser tab to exit Renev AI');
                        break;
                        
                    case 'setLanguage':
                        const lang = target.getAttribute('data-language');
                        setLanguage(lang);
                        break;
                }
            }

            function showWelcomeModal() {
                const content = `
                    <div class="modal-header">
                        <span class="modal-title">Welcome to Renev AI</span>
                    </div>
                    <div class="modal-content">
                        <p>This is the first official version of Renev AI. Welcome to version 1.0.</p>
                        <p>Developed and manufactured by Renev Official.</p>
                        <p>Renev AI is powered by the Renev Byte One model. For the model, the special launcher Renev Nova One is built.</p>
                        <button class="modal-button" data-action="getStarted">Launch Renev AI</button>
                    </div>
                `;
                showModal(content);
            }

            function showAboutModal() {
                const content = `
                    <div class="modal-header">
                        <span class="modal-title">About Renev AI</span>
                    </div>
                    <div class="modal-content">
                        <p>Important: The name of the program has changed. The previous name was SyberAI.</p>
                        <p>Developed and manufactured by Renev Official.</p>
                        <p>Renev AI is powered by the Renev Byte One model. For the model, the special launcher Renev Nova One is built.</p>
                    </div>
                `;
                showModal(content);
            }

            function showNotification(message) {
                if (!notificationsEnabled) return;
                
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }

            window.handleContact = function() {
                const email = 'renev.official@gmail.com';
                const subject = 'Renev AI - Contact';
                const body = ''; 
                
                try {
                    window.location.href = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                } catch (error) {
                    const mailtoLink = document.createElement('a');
                    mailtoLink.href = `mailto:${email}?subject=${encodeURIComponent(subject)}`;
                    mailtoLink.click();
                }
            };

            function handleFullscreen() {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => {
                        console.error(`Error attempting to enable fullscreen: ${err.message}`);
                    });
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    }
                }
            }

            function setLanguage(lang) {
                currentLanguage = lang;
                localStorage.setItem(STORAGE_KEYS.LANGUAGE, lang);
                closeModal();
                showSettingsModal();
                showNotification(`Language changed to: ${lang}`);
            }

            function resetChat() {
                const chatMessages = document.querySelector('.chat-messages');
                if (chatMessages) {
                    chatMessages.innerHTML = '';
                    const welcomeMessage = document.createElement('div');
                    welcomeMessage.className = 'chat-message bot';
                    welcomeMessage.textContent = WELCOME_MESSAGE;
                    chatMessages.appendChild(welcomeMessage);
                }
                messageHistory = [];
                showNotification('Chat has been reset');
            }

            // Error handling helper
            function handleAPIError(error) {
                if (error.name === 'AbortError') {
                    return 'The request timed out. Please try again.';
                }
                if (error.message.includes('status 429')) {
                    return 'Too many requests. Please wait a moment and try again.';
                }
                if (error.message.includes('status 503')) {
                    return 'The service is temporarily unavailable. Please try again later.';
                }
                return 'An error occurred. Please try again.';
            }

            document.addEventListener('DOMContentLoaded', function() {
                const navigation = document.querySelector('.navigation');
                if (navigation) {
                    navigation.innerHTML = `
                        <div class="nav-left">
                            <button class="nav-button" onclick="handleContact()">
                                <span class="material-icons">mail</span>
                                Contact
                            </button>
                            <button class="nav-button" id="fullscreenButton">
                                <span class="material-icons">fullscreen</span>
                                Fullscreen
                            </button>
                        </div>
                        <div class="nav-right">
                            <button class="nav-button icon-only" onclick="showSettingsModal()">
                                <span class="material-icons">settings</span>
                            </button>
                        </div>
                    `;
                }
                showWelcomeModal();
                showNotification('Renev AI V0.9');
                
                const messageInput = document.getElementById('messageInput');
                const sendButton = document.querySelector('.chat-input-container button');

                // Pas de hoogte aan bij elke invoer
                messageInput.addEventListener('input', adjustInputHeight);
                
                messageInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey && !isWaitingForResponse) {
                        e.preventDefault();
                        const message = this.value.trim();
                        if (message) {
                            sendMessage();
                        }
                    }
                });

                sendButton.addEventListener('click', function() {
                    if (!isWaitingForResponse) {
                        const message = messageInput.value.trim();
                        if (message) {
                            sendMessage();
                        }
                    }
                });

                document.querySelector('.brand').addEventListener('click', showAboutModal);
                
                const settingsButton = document.querySelector('.nav-button.icon-only');
                if (settingsButton) {
                    settingsButton.addEventListener('click', showSettingsModal);
                }

                // Fullscreen knop functionaliteit
                const fullscreenButton = document.getElementById('fullscreenButton');
                if (fullscreenButton) {
                    fullscreenButton.addEventListener('click', function() {
                        if (!document.fullscreenElement) {
                            document.documentElement.requestFullscreen().catch(err => {
                                console.error(`Error attempting to enable fullscreen: ${err.message}`);
                            });
                        } else {
                            if (document.exitFullscreen) {
                                document.exitFullscreen();
                            }
                        }
                    });
                }

                // Laad de opgeslagen taal bij het starten
                const savedLanguage = localStorage.getItem(STORAGE_KEYS.LANGUAGE);
                if (savedLanguage) {
                    currentLanguage = savedLanguage;
                }

                // Voeg enter key handler toe voor mobiel
                messageInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey && !isWaitingForResponse) {
                        if (window.innerWidth <= 768) {
                            e.preventDefault();
                            const message = this.value.trim();
                            if (message) {
                                sendMessage();
                            }
                        }
                    }
                });
            });
        })();
    </script>
</body>
</html>